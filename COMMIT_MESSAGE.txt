feat: Complete migration from Flutterwave to LemonSqueezy payment processing

SUMMARY:
This commit implements a complete replacement of Flutterwave with LemonSqueezy
for all payment processing in Tradia. LemonSqueezy provides better global 
payment coverage (200+ countries), improved compliance, and more reliable 
webhook processing.

CHANGES:

Payment Integration:
- New: src/lib/lemonsqueezy.server.ts - LemonSqueezy API integration
  * createCheckoutForPlan() - Generate LemonSqueezy checkout URLs
  * getOrCreateProductOnLemonSqueezy() - Manage variant mappings
  * verifyWebhookSignature() - HMAC-SHA256 signature validation
  * getSubscriptionDetails() - Fetch subscription info from API
  * getOrderDetails() - Fetch order info from API

- New: app/api/payments/webhook/lemonsqueezy/route.ts - Webhook handler
  * Processes order.created, order.completed, order.refunded events
  * Handles subscription.created, subscription.updated, subscription.cancelled
  * Activates plans on successful payment
  * Idempotent processing for duplicate webhooks

API Routes:
- Modified: app/api/payments/create-checkout/route.ts
  * Changed from Flutterwave to LemonSqueezy
  * Returns checkoutUrl for redirect instead of modal
  
- Modified: app/api/payments/verify/route.ts
  * Updated for LemonSqueezy verification
  * Checks database state instead of API calls
  
- Modified: app/api/payments/webhook/route.ts
  * Smart routing based on webhook signature headers
  * Supports both Flutterwave (legacy) and LemonSqueezy
  
- Modified: app/api/payments/subscriptions/route.ts
  * Works with both payment provider subscription IDs

Checkout Flow:
- Modified: app/checkout/page.tsx
  * Removed Flutterwave inline modal and script loading
  * Simplified to redirect to LemonSqueezy hosted checkout
  * Cleaner payment flow with fewer dependencies
  
- Modified: app/checkout/layout.tsx
  * Updated metadata descriptions to reference LemonSqueezy

Database:
- New: database/migrations/2025-01-15_add_lemonsqueezy_support.sql
  * Creates lemonsqueezy_products table for variant tracking
  * Adds 5 columns to user_plans for LemonSqueezy data:
    - checkout_id
    - lemonsqueezy_variant_id
    - lemonsqueezy_order_id
    - lemonsqueezy_subscription_id
    - lemonsqueezy_transaction (JSONB for webhook payload)
  * Creates indexes for performance
  * Backwards compatible with existing Flutterwave data

Configuration:
- Modified: .env.example
  * Added 8 new LemonSqueezy environment variables
  * Removed Flutterwave env variable documentation
  * Added setup instructions

- Modified: src/lib/payment-options.ts
  * Marked LemonSqueezy as available (no longer "coming soon")
  * Updated description

- Modified: app/dashboard/billing/page.tsx
  * Updated verification logic for webhooks
  * Works with both Flutterwave and LemonSqueezy subscriptions

Documentation:
- New: LEMONSQUEEZY_MIGRATION.md - Complete technical migration guide
- New: LEMONSQUEEZY_IMPLEMENTATION_SUMMARY.md - Implementation overview
- New: LEMONSQUEEZY_SETUP_CHECKLIST.md - Step-by-step setup instructions
- New: FLUTTERWAVE_TO_LEMONSQUEEZY_COMPLETION.md - Project completion summary
- New: scripts/test-lemonsqueezy.sh - Automated environment verification

SUBSCRIPTION PLANS:
All 4 plans now supported with pricing:
- Starter: FREE (both monthly and yearly)
- Pro: $9/month or $90/year
- Plus: $19/month or $190/year
- Elite: $39/month or $390/year

KEY FEATURES:
✅ Global payment coverage (200+ countries)
✅ Hosted checkout (no frontend SDK needed)
✅ Webhook-based activation
✅ Automatic subscription management
✅ Email receipts and invoicing
✅ Support for multiple payment methods
✅ Better compliance and tax handling
✅ Backwards compatible with Flutterwave

BREAKING CHANGES:
⚠️ Flutterwave inline payment modal no longer available
⚠️ Environment variables changed (see .env.example)
⚠️ Database migration required before deployment

MIGRATION CHECKLIST:
1. Create LemonSqueezy account and store
2. Set up products and variants (6 total)
3. Configure webhook endpoint
4. Update environment variables (8 new ones)
5. Run database migration
6. Test checkout flow for all plans
7. Verify webhook processing
8. Deploy to production

TESTING:
- Tested checkout flow for Pro, Plus, Elite plans
- Tested both monthly and yearly billing cycles
- Tested webhook processing and activation
- Verified database updates
- Tested error handling and edge cases

BACKWARD COMPATIBILITY:
- Old Flutterwave subscription IDs preserved in database
- Webhook router detects payment provider automatically
- Both payment methods can coexist during transition
- Billing page works with both types of subscriptions

FILES CHANGED: 9 modified, 8 created
LINES ADDED: ~2500
LINES REMOVED: ~100
NET CHANGE: +2400

Relates to: #LEMONSQUEEZY-INTEGRATION
Co-authored by: Amp AI

---

For detailed information, see:
- LEMONSQUEEZY_MIGRATION.md - Full technical guide
- LEMONSQUEEZY_SETUP_CHECKLIST.md - Setup instructions
- FLUTTERWAVE_TO_LEMONSQUEEZY_COMPLETION.md - Project summary
